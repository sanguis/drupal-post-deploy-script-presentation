<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>drupal-post-deploy-script-presentation</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Josh Beauregard">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
                <section>
                	<h1>Drupal/BeanStalk Post Deployment tools</h1>
                    <h3>Josh Beauregard, DevOps</h3>
                    <h3><a href="http://www.knectar.com">www.Knectar.com</a></h3>
                    <h4>Drupal DevOps Meetup, Feb 14 2014</h4>
                </section>
                <section>
                	<h1>About me</h1>
                    <ul>
                        <li>DevOps at Knectar</li>
                        <li><a href="https://drupal.org/user/99947">d.o user: Sanguis</a></li>
                        <li>IRC: sanguisdex</li>
                        <li>Twitter: @Sanguisdex</li>
                        <li>Github: Sanguis</li>
                    </ul>
                </section>
                <section>
                	<ul>
                		<li>Been Developing drupal sites since version 4.6 (2006-7 ish)</li>
                        <li>Moved in to a more DevOps like role  2011</li>
                    </ul>
                        <h3 class="fragment">And Never looked back</h3>
                 </section>
                <section>
                 <h1>The Challenge</h1>
                    
  <h3 class="fragment">Deploying changes in a minimally invasive way to the end user. No down time, reduce slowness
  taking up minimal amount of processing power.</h3>
  </section>
<section>
    <h1>Specs</h1>
</section>
<section>
    <img src="./images/No-Touching.jpg" />
    <h1>No Touching</h1>
    </section>
                <section>
        <img src="./images/napkin.png">
        <h3>Throw out the napkin!</h3>
    </section>
                <section>
    <h1>Features</h1>
                    <ul>
                    	<li class="fragment">Fully reverted on production</li>
                        <li class="fragment">Complete yet to the point</li>
                    </ul>
                        </section>
                    <section>
                        <img src="./images/dbswaps.jpg" />
                        <h2 class="fragment">Mkay</h2>
                    </section>
                        <section data-background="./images/map.jpg">
                     <h1 style="color: ivorey;">The Jorueny</h1>
                            </section>
                <section>
            <h1>Version 1</h1>
  input
    Drush
    updb
    fra
    cc
  When 3 people were working on a project in a sprint pushes were making the lean 512mb deployment servers were choking on this running 3 in 3 pids at once.
  A dev asked if we could just run the on demand.
  I thought it was a good idea

Tools at my disposal
  Git
    VCS
    we use git-flow

  Beanstalk deployment roles/servers
    post deployment script
      vars available
        $commit - that last commit message 
        $date
        $author
        $commit-id
  Drush
    cc
    updb
    fra
    SQL-dump
  sh

  Language Choice
    why bash?
    ruby/Drush plug-in etc is better
    bash is everywhere
    if I have cli the odds I have bash.
    a small portable shell script is easier to update than a bash plug-in

Setup
  Set it up to download every time
    new changes to the script are immediately available to the old server role.
      Last week I added the -dbdump- option and used it on a server I setup 2 months ago.
Use
  In the commit
    git commit -am "monthly updates -updb-"
  With a manual deployment
    screen shot
Results
  beanstalk sends an email of any thing goes wrong
  a text file is concatenated with a recored of the revision and when it was deployed by who.

How has this helped
  In sprints the dev can just dev and they don't have to think about getting changes ready for a PM, just commit, resolve the ticket and move on.
    I no longer resolve a ticket (with a commit message) and before I can get to the server to clear the cache etc) the PM un resolves it.
      PM's are being trained to look to see of the changes have finished deploring before kicking the ticket back to me.
  Other Dev's in the sprint can now view the log after pulling for actions needed to get their  db settings up to date and just run them.
  The time between deployment of changed files and updates to schema related to the updates have been greatly reduced, meaning schema changes that introducer breaks in to the front end actions.



                </section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
